<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lumina Optics | Luxury Eyewear Boutique</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Tailwind Configuration for Custom Colors & Dark Mode -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        luxury: {
                            base: 'var(--color-base)',
                            surface: 'var(--color-surface)',
                            primary: 'var(--color-primary)',
                            accent: 'var(--color-accent)',
                            secondary: 'var(--color-secondary)',
                            text: 'var(--color-text)',
                        }
                    },
                    fontFamily: {
                        serif: ['Georgia', 'serif'],
                        sans: ['Helvetica Neue', 'Arial', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    
    <style>
        /* CSS Variables for Dynamic Theme Switching */
        :root {
            --color-base: #F9F8F6;
            --color-surface: #FFFFFF;
            --color-primary: #2C2C2C;
            --color-accent: #D4AF37;
            --color-secondary: #E5E2DD;
            --color-text: #4A4A4A;
        }

        .dark {
            --color-base: #121212;
            --color-surface: #1E1E1E;
            --color-primary: #F9F8F6;
            --color-accent: #E5C158; /* Slightly brighter gold for contrast */
            --color-secondary: #2D2D2D;
            --color-text: #A0A0A0;
        }

        body {
            background-color: var(--color-base);
            color: var(--color-primary);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Custom Scrollbar for luxury feel */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: var(--color-base);
        }
        ::-webkit-scrollbar-thumb {
            background: var(--color-accent);
            border-radius: 4px;
        }

        /* Transition Utilities */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Modal animations */
        .modal-enter {
            opacity: 1 !important;
        }
        .modal-content-enter {
            transform: scale(1) !important;
        }
    </style>
</head>
<body class="font-sans antialiased min-h-screen flex flex-col">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-luxury-base/95 backdrop-blur-sm border-b border-luxury-secondary shadow-sm transition-colors duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <!-- Logo -->
                <div class="flex-shrink-0 flex items-center cursor-pointer" onclick="navigateTo('home')">
                    <span class="font-serif text-2xl tracking-widest font-bold text-luxury-primary">LUMINA</span>
                    <span class="text-luxury-accent text-3xl ml-1">.</span>
                </div>
                
                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center space-x-8">
                    <button onclick="navigateTo('home')" class="text-luxury-text hover:text-luxury-accent transition-colors duration-300 font-medium tracking-wide">HOME</button>
                    <button onclick="navigateTo('shop')" class="text-luxury-text hover:text-luxury-accent transition-colors duration-300 font-medium tracking-wide">COLLECTION</button>
                    <button onclick="navigateTo('stylist')" class="text-luxury-accent hover:text-luxury-primary transition-colors duration-300 font-medium tracking-wide flex items-center gap-1">‚ú® AI STYLIST</button>
                    <button onclick="navigateTo('about')" class="text-luxury-text hover:text-luxury-accent transition-colors duration-300 font-medium tracking-wide">OUR STORY</button>
                    
                    <div class="h-6 w-px bg-luxury-secondary mx-2"></div> <!-- Divider -->

                    <!-- Theme Toggler -->
                    <button onclick="toggleTheme()" class="text-luxury-text hover:text-luxury-accent transition-colors duration-300 focus:outline-none flex items-center justify-center text-xl" aria-label="Toggle Dark Mode">
                        <span class="theme-icon">üåô</span>
                    </button>
                </div>

                <!-- Mobile Menu Icons -->
                <div class="md:hidden flex items-center gap-4">
                    <button onclick="toggleTheme()" class="text-luxury-text hover:text-luxury-accent focus:outline-none p-2 text-xl" aria-label="Toggle Dark Mode">
                        <span class="theme-icon">üåô</span>
                    </button>
                    <button onclick="toggleMobileMenu()" class="text-luxury-primary hover:text-luxury-accent focus:outline-none p-2">
                        <span class="text-2xl">&#9776;</span>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Mobile Menu (Hidden by default) -->
        <div id="mobile-menu" class="hidden md:hidden absolute w-full bg-luxury-surface border-t border-luxury-secondary shadow-xl z-40 left-0 transition-colors duration-300">
            <div class="px-4 pt-2 pb-6 space-y-1">
                <button onclick="navigateTo('home'); toggleMobileMenu()" class="block w-full text-left px-4 py-4 text-luxury-text hover:bg-luxury-secondary hover:text-luxury-primary rounded-md text-lg font-medium border-b border-luxury-secondary/30 transition-colors">Home</button>
                <button onclick="navigateTo('shop'); toggleMobileMenu()" class="block w-full text-left px-4 py-4 text-luxury-text hover:bg-luxury-secondary hover:text-luxury-primary rounded-md text-lg font-medium border-b border-luxury-secondary/30 transition-colors">Collection</button>
                <button onclick="navigateTo('stylist'); toggleMobileMenu()" class="block w-full text-left px-4 py-4 text-luxury-accent hover:bg-luxury-secondary hover:text-luxury-primary rounded-md text-lg font-medium border-b border-luxury-secondary/30 transition-colors">‚ú® AI Stylist</button>
                <button onclick="navigateTo('about'); toggleMobileMenu()" class="block w-full text-left px-4 py-4 text-luxury-text hover:bg-luxury-secondary hover:text-luxury-primary rounded-md text-lg font-medium transition-colors">Our Story</button>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main id="app-content" class="flex-grow w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Content injected via JS -->
    </main>

    <!-- Product Detail Modal -->
    <div id="product-modal" class="fixed inset-0 z-[100] flex items-center justify-center hidden opacity-0 transition-opacity duration-300">
        <!-- Backdrop -->
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm cursor-pointer" onclick="closeProductModal()"></div>
        <!-- Modal Content -->
        <div class="relative bg-luxury-surface w-full max-w-4xl mx-4 rounded-xl shadow-2xl overflow-hidden flex flex-col md:flex-row transform scale-95 transition-transform duration-300 border border-luxury-secondary" id="product-modal-content">
            <!-- Injected by JS -->
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-luxury-primary text-luxury-base py-12 mt-auto transition-colors duration-300">
        <div class="max-w-7xl mx-auto px-4 grid grid-cols-1 md:grid-cols-3 gap-8 text-sm">
            <div>
                <h3 class="font-serif text-lg text-luxury-accent mb-4">LUMINA.</h3>
                <p class="opacity-80 leading-relaxed text-luxury-base">Curating the world's finest eyewear for the discerning individual. Trust, passion, and visionary design.</p>
            </div>
            <div>
                <h3 class="font-bold mb-4 tracking-wider text-luxury-base">VISIT US</h3>
                <p class="opacity-80 text-luxury-base">123 Visionary Way</p>
                <p class="opacity-80 text-luxury-base">Design District, NY 10012</p>
                <p class="opacity-80 mt-2 text-luxury-base">+1 (555) 019-2024</p>
            </div>
            <div>
                <h3 class="font-bold mb-4 tracking-wider text-luxury-base">HOURS</h3>
                <div class="flex justify-between max-w-xs opacity-80 text-luxury-base">
                    <span>Mon - Fri</span>
                    <span>10:00 - 19:00</span>
                </div>
                <div class="flex justify-between max-w-xs opacity-80 mt-1 text-luxury-base">
                    <span>Sat</span>
                    <span>11:00 - 18:00</span>
                </div>
            </div>
        </div>
        <div class="text-center text-xs opacity-50 mt-12 pt-8 border-t border-luxury-secondary/30 text-luxury-base flex flex-col items-center gap-4">
            <p>&copy; 2026 Lumina Optics. All Rights Reserved.</p>
            
            <!-- Seamless Admin Collection Import -->
            <div class="flex gap-6 opacity-70">
                <button onclick="document.getElementById('csvFileInput').click()" class="hover:text-luxury-accent transition-colors cursor-pointer">Import Collection (.csv)</button>
                <button onclick="downloadCSVTemplate()" class="hover:text-luxury-accent transition-colors cursor-pointer">Download CSV Template</button>
                <input type="file" id="csvFileInput" accept=".csv" class="hidden" onchange="handleCSVUpload(event)">
            </div>
        </div>
    </footer>

    <!-- Toast Notification Container -->
    <div id="toast-container" class="fixed bottom-5 right-5 z-50 flex flex-col gap-3 pointer-events-none"></div>

    <!-- JavaScript Application Logic -->
    <script>
        // --- DATA STORE ---
        
        // Products Database with updated shape attributes for SVGs
        const products = [
            { id: 1, brand: 'ic! berlin', name: 'The Haptic', type: 'Optical', color: 'Black', price: 540, weight: 14, material: 'Stainless Steel', imageColor: '#2C2C2C', shape: 'rectangular', desc: 'A masterclass in screwless hinge technology. The Haptic provides architectural rigidity with feather-light wearability.' },
            { id: 2, brand: 'ic! berlin', name: 'Urban Pulse', type: 'Sunglasses', color: 'Gold', price: 620, weight: 16, material: 'Stainless Steel', imageColor: '#D4AF37', shape: 'aviator', desc: 'A modern, angular take on the classic aviator. Designed for the urban commuter who values both style and durability.' },
            { id: 3, brand: 'Tom Ford', name: 'FT5532', type: 'Optical', color: 'Tortoise', price: 495, weight: 28, material: 'Acetate', imageColor: '#5C4033', shape: 'square', desc: 'The quintessential bold academic frame. Signature T-logo hardware seamlessly integrated into a premium Italian acetate chassis.' },
            { id: 4, brand: 'Tom Ford', name: 'Snowdon', type: 'Sunglasses', color: 'Black', price: 450, weight: 32, material: 'Acetate', imageColor: '#1A1A1A', shape: 'square', desc: 'Iconic cinematic style. The Snowdon offers a robust, confident silhouette with polarized lenses for ultimate clarity.' },
            { id: 5, brand: 'Talla', name: 'Geometrico', type: 'Optical', color: 'Silver', price: 480, weight: 18, material: 'Titanium', imageColor: '#9CA3AF', shape: 'round', desc: 'Parisian elegance meets geometric perfection. A subtle rounding of the lens accommodates a variety of facial structures.' },
            { id: 6, brand: 'Talla', name: 'Sun Architect', type: 'Sunglasses', color: 'Blue', price: 510, weight: 20, material: 'Titanium', imageColor: '#4682B4', shape: 'rectangular', desc: 'Structured and commanding. Features custom-tinted lenses housed in an impossibly thin titanium wireframe.' },
            { id: 7, brand: 'Orgreen', name: 'Quantum High', type: 'Optical', color: 'Blue', price: 580, weight: 12, material: 'Titanium', imageColor: '#1E3A8A', shape: 'rectangular', desc: 'Danish minimalism at its peak. Hand-applied colorways contrast interior and exterior surfaces.' },
            { id: 8, brand: 'Orgreen', name: 'Nordic Light', type: 'Sunglasses', color: 'Silver', price: 610, weight: 15, material: 'Polyamide', imageColor: '#A0AEC0', shape: 'aviator', desc: 'Ultra-lightweight 3D printed polyamide combined with titanium temples for a near-weightless sun-protection experience.' },
            { id: 9, brand: 'ic! berlin', name: 'Silk Collection', type: 'Optical', color: 'Gold', price: 590, weight: 11, material: 'Stainless Steel', imageColor: '#C5A000', shape: 'round', desc: 'The thinnest sheet metal collection ever produced by the Berlin design house. An exercise in pure reduction.' },
            { id: 10, brand: 'Tom Ford', name: 'Blue Block', type: 'Optical', color: 'Black', price: 420, weight: 30, material: 'Acetate', imageColor: '#000000', shape: 'square', desc: 'Ready-to-wear blue light filtering lenses set into a classic, universally flattering square frame.' },
            { id: 11, brand: 'Orgreen', name: 'Havana Nights', type: 'Sunglasses', color: 'Tortoise', price: 550, weight: 19, material: 'Titanium', imageColor: '#8B4513', shape: 'round', desc: 'A nod to mid-century resort wear, featuring gradient lenses and warm tortoise-shell detailing over titanium.' },
            { id: 12, brand: 'Talla', name: 'Modernist', type: 'Optical', color: 'Tortoise', price: 460, weight: 22, material: 'Acetate', imageColor: '#6F4E37', shape: 'rectangular', desc: 'A soft rectangular shape that brings mid-century warmth into contemporary focus with sculpted acetate.' }
        ];

        // State Management
        let appState = {
            currentPage: 'home',
            filters: { brand: 'All', color: 'All', type: 'All' },
            sortBy: 'featured'
        };

        // --- CSV IMPORT LOGIC ---
        function handleCSVUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const text = e.target.result;
                try {
                    const newProducts = parseCSV(text);
                    if (newProducts.length > 0) {
                        products.push(...newProducts);
                        
                        showGenericToast(`Successfully imported ${newProducts.length} frames!`);
                        
                        // Re-render shop page if active to show new items immediately
                        if (appState.currentPage === 'shop') {
                            appState.filters = { brand: 'All', color: 'All', type: 'All' };
                            renderPage('shop', false);
                        }
                    } else {
                        showGenericToast("No valid products found in CSV.");
                    }
                } catch (err) {
                    console.error("CSV Parse Error", err);
                    showGenericToast("Error parsing CSV format.");
                }
            };
            reader.readAsText(file);
            
            // Reset input so you can re-upload the same file if needed
            event.target.value = '';
        }

        function parseCSV(text) {
            const lines = text.split('\n').filter(l => l.trim().length > 0);
            if (lines.length < 2) return []; // Needs at least headers and one row

            // Regex to match commas NOT inside quotes
            const splitRegex = /,(?=(?:(?:[^"]*"){2})*[^"]*$)/;
            
            const headers = lines[0].split(splitRegex).map(h => h.trim().replace(/^"|"$/g, '').toLowerCase());
            const result = [];
            let startId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;

            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(splitRegex).map(v => v.trim().replace(/^"|"$/g, ''));
                let product = { id: startId++ };
                
                let isValid = false;
                headers.forEach((h, index) => {
                    let val = values[index];
                    if (val !== undefined) {
                        if (h === 'price' || h === 'weight') val = parseFloat(val) || 0;
                        product[h] = val;
                        if (h === 'name' && val) isValid = true; 
                    }
                });

                if (isValid) {
                    // Fallbacks for missing SVGs & data aesthetics
                    product.imageColor = product.imagecolor || product.imageColor || '#000000';
                    product.shape = (product.shape || 'rectangular').toLowerCase();
                    product.type = product.type || 'Optical';
                    product.desc = product.desc || 'No description provided.';
                    product.color = product.color || 'Unknown';
                    product.material = product.material || 'Acetate';
                    product.brand = product.brand || 'Lumina Collection';
                    
                    result.push(product);
                }
            }
            return result;
        }

        function downloadCSVTemplate() {
            const headers = "brand,name,type,color,price,weight,material,imageColor,shape,desc\n";
            const sampleRow1 = '"New Brand","Model X","Sunglasses","Black",350,22,"Acetate","#000000","round","A fantastic new frame."\n';
            const sampleRow2 = '"Minimalist","Thin Wire","Optical","Gold",450,12,"Titanium","#D4AF37","aviator","Featherweight opticals."\n';
            
            const csvContent = "data:text/csv;charset=utf-8," + headers + sampleRow1 + sampleRow2;
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "lumina_inventory_template.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // --- THEME / DARK MODE LOGIC ---
        function toggleTheme() {
            document.documentElement.classList.toggle('dark');
            const isDark = document.documentElement.classList.contains('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            updateThemeIcons(isDark);
            
            // Re-render current page to update SVG stroke/fill colors if necessary
            if (appState.currentPage === 'shop' || appState.currentPage === 'home' || appState.currentPage === 'cart') {
                renderPage(appState.currentPage, false); // false = no scroll
            }
        }

        function updateThemeIcons(isDark) {
            const icons = document.querySelectorAll('.theme-icon');
            icons.forEach(icon => { icon.innerHTML = isDark ? '‚òÄÔ∏è' : 'üåô'; });
        }

        // Initialize theme
        function initTheme() {
            const isDark = localStorage.getItem('theme') === 'dark' || 
                          (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches);
            if (isDark) {
                document.documentElement.classList.add('dark');
            }
            updateThemeIcons(isDark);
        }

        // --- DYNAMIC SVG EYEWEAR GENERATOR ---
        function getGlassesSVG(product, width="100%", height="100%", className="") {
            const isDark = document.documentElement.classList.contains('dark');
            
            // Colors and opacity logic based on optical vs sunglass
            let lensFill = 'transparent';
            let lensOpacity = '1';
            let strokeColor = product.imageColor;
            
            // Dark mode overrides for better visibility
            if (isDark && (product.color === 'Black' || strokeColor === '#000000' || strokeColor === '#1A1A1A' || strokeColor === '#2C2C2C')) {
                strokeColor = '#FFFFFF'; 
            }

            if (product.type === 'Sunglasses') {
                lensFill = strokeColor;
                lensOpacity = '0.85';
            } else {
                lensFill = strokeColor;
                lensOpacity = '0.08'; // Subtle tint for optical lenses
            }

            const sw = 2.5; // Stroke width
            let lenses = '';
            let bridge = '';
            
            // Shared arms in the background
            const arms = `<path d="M 12 15 L 2 5 M 88 15 L 98 5" stroke="${strokeColor}" stroke-width="${sw}" fill="none" opacity="0.5"/>`;

            switch(product.shape) {
                case 'round':
                    lenses = `
                        <circle cx="28" cy="22" r="16" fill="${lensFill}" fill-opacity="${lensOpacity}" stroke="${strokeColor}" stroke-width="${sw}"/>
                        <circle cx="72" cy="22" r="16" fill="${lensFill}" fill-opacity="${lensOpacity}" stroke="${strokeColor}" stroke-width="${sw}"/>
                    `;
                    bridge = `<path d="M 44 22 Q 50 14 56 22" fill="none" stroke="${strokeColor}" stroke-width="${sw}"/>`;
                    break;
                case 'square':
                    lenses = `
                        <rect x="10" y="7" width="36" height="30" rx="5" fill="${lensFill}" fill-opacity="${lensOpacity}" stroke="${strokeColor}" stroke-width="${sw}"/>
                        <rect x="54" y="7" width="36" height="30" rx="5" fill="${lensFill}" fill-opacity="${lensOpacity}" stroke="${strokeColor}" stroke-width="${sw}"/>
                    `;
                    bridge = `<line x1="46" y1="18" x2="54" y2="18" stroke="${strokeColor}" stroke-width="${sw}"/>`;
                    break;
                case 'rectangular':
                    lenses = `
                        <rect x="12" y="12" width="34" height="20" rx="3" fill="${lensFill}" fill-opacity="${lensOpacity}" stroke="${strokeColor}" stroke-width="${sw}"/>
                        <rect x="54" y="12" width="34" height="20" rx="3" fill="${lensFill}" fill-opacity="${lensOpacity}" stroke="${strokeColor}" stroke-width="${sw}"/>
                    `;
                    bridge = `<line x1="46" y1="18" x2="54" y2="18" stroke="${strokeColor}" stroke-width="${sw}"/>`;
                    break;
                case 'aviator':
                default:
                    lenses = `
                        <path d="M 12 18 C 12 6, 28 6, 42 12 C 45 25, 38 38, 26 36 C 16 34, 12 28, 12 18 Z" fill="${lensFill}" fill-opacity="${lensOpacity}" stroke="${strokeColor}" stroke-width="${sw}" stroke-linejoin="round"/>
                        <path d="M 88 18 C 88 6, 72 6, 58 12 C 55 25, 62 38, 74 36 C 84 34, 88 28, 88 18 Z" fill="${lensFill}" fill-opacity="${lensOpacity}" stroke="${strokeColor}" stroke-width="${sw}" stroke-linejoin="round"/>
                    `;
                    // Aviators get a signature double bridge
                    bridge = `
                        <path d="M 40 14 Q 50 10 60 14 M 42 18 L 58 18" fill="none" stroke="${strokeColor}" stroke-width="${sw}"/>
                    `;
                    break;
            }

            return `<svg class="${className}" viewBox="0 0 100 44" width="${width}" height="${height}" xmlns="http://www.w3.org/2000/svg">
                ${arms}
                ${lenses}
                ${bridge}
            </svg>`;
        }


        // --- NAVIGATION LOGIC ---
        function navigateTo(pageId) {
            appState.currentPage = pageId;
            const contentDiv = document.getElementById('app-content');
            
            // Fade out effect
            contentDiv.style.opacity = '0';
            
            setTimeout(() => {
                renderPage(pageId, true);
                contentDiv.style.opacity = '1';
                contentDiv.style.transition = 'opacity 0.3s ease-in';
            }, 200);
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }

        function renderPage(pageId, doScroll = true) {
            const contentDiv = document.getElementById('app-content');
            contentDiv.innerHTML = ''; // Clear current content

            switch(pageId) {
                case 'home': renderHome(contentDiv); break;
                case 'shop': renderShop(contentDiv); break;
                case 'stylist': renderStylist(contentDiv); break;
                case 'about': renderAbout(contentDiv); break;
                default: renderHome(contentDiv);
            }
            if(doScroll) window.scrollTo(0, 0);
        }

        // --- PAGE RENDERERS ---

        function renderHome(container) {
            container.innerHTML = `
                <!-- Hero Section -->
                <section class="relative bg-luxury-surface border border-luxury-secondary rounded-xl overflow-hidden shadow-lg mb-16 fade-in">
                    <div class="absolute inset-0 bg-gradient-to-r from-luxury-primary/5 to-transparent"></div>
                    <div class="relative z-10 px-8 py-24 md:py-32 flex flex-col items-start justify-center text-center md:text-left">
                        <h2 class="font-serif text-xl text-luxury-accent tracking-widest mb-4">EST. 2005</h2>
                        <h1 class="font-serif text-4xl md:text-6xl text-luxury-primary font-bold mb-6 leading-tight">
                            Clarify Your<br/>Perspective.
                        </h1>
                        <p class="text-luxury-text text-lg mb-8 max-w-lg">
                            Discover an exclusive curation of the world's finest optical engineering. 
                            Featuring ic! berlin, Tom Ford, and more.
                        </p>
                        <button onclick="navigateTo('shop')" class="bg-luxury-primary text-luxury-base px-8 py-4 rounded-sm hover:bg-luxury-accent transition-colors duration-300 tracking-wider font-bold shadow-md">
                            EXPLORE THE COLLECTION
                        </button>
                    </div>
                    <!-- Decorative Circle representing a lens -->
                    <div class="absolute -right-20 -bottom-40 w-96 h-96 rounded-full border-[30px] border-luxury-secondary opacity-30 hidden md:block"></div>
                </section>

                <!-- Featured Brands Strip -->
                <section class="mb-20 text-center fade-in">
                    <p class="text-sm font-bold tracking-widest text-luxury-text/50 mb-8 uppercase">Our Partners</p>
                    <div class="flex flex-wrap justify-center gap-12 md:gap-24 opacity-60 grayscale hover:grayscale-0 transition-all duration-500 text-luxury-primary">
                        <div class="text-xl font-bold font-serif">ic! berlin</div>
                        <div class="text-xl font-bold font-serif">TOM FORD</div>
                        <div class="text-xl font-bold font-serif">TALLA</div>
                        <div class="text-xl font-bold font-serif">√òRGREEN</div>
                    </div>
                </section>

                <!-- Featured Products Preview -->
                <section class="mb-16 fade-in">
                    <div class="flex justify-between items-end mb-8">
                        <div>
                            <h2 class="text-3xl font-serif text-luxury-primary mb-2">Curated Highlights</h2>
                            <p class="text-luxury-text text-sm max-w-md">Handpicked frames that define the season's aesthetic.</p>
                        </div>
                        <button onclick="navigateTo('shop')" class="text-luxury-accent hover:text-luxury-primary font-bold text-sm tracking-wide border-b border-luxury-accent pb-1">VIEW ALL</button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        ${products.slice(0, 3).map(product => createProductCard(product)).join('')}
                    </div>
                </section>
                
                <!-- CTA Banner -->
                <section class="bg-luxury-primary text-luxury-base p-12 rounded-xl text-center md:flex md:justify-between md:items-center fade-in">
                    <div class="md:text-left mb-6 md:mb-0">
                        <h3 class="text-2xl font-serif mb-2 text-luxury-base">Not sure what fits?</h3>
                        <p class="opacity-80 text-luxury-base">Consult our AI Stylist to find the perfect frame for your face shape and lifestyle.</p>
                    </div>
                    <button onclick="navigateTo('stylist')" class="border border-luxury-accent text-luxury-accent px-8 py-3 rounded-sm hover:bg-luxury-accent hover:text-white transition-all duration-300">
                        CONSULT AI STYLIST ‚ú®
                    </button>
                </section>
            `;
        }

        function renderShop(container) {
            // Filter Logic
            let filteredProducts = products.filter(p => {
                return (appState.filters.brand === 'All' || p.brand === appState.filters.brand) &&
                       (appState.filters.color === 'All' || p.color === appState.filters.color) &&
                       (appState.filters.type === 'All' || p.type === appState.filters.type);
            });

            // Sort Logic
            if (appState.sortBy === 'priceAsc') {
                filteredProducts.sort((a, b) => a.price - b.price);
            } else if (appState.sortBy === 'priceDesc') {
                filteredProducts.sort((a, b) => b.price - a.price);
            } else if (appState.sortBy === 'az') {
                filteredProducts.sort((a, b) => a.name.localeCompare(b.name));
            }

            // Extract unique options for filters
            const brands = ['All', ...new Set(products.map(p => p.brand))];
            const colors = ['All', ...new Set(products.map(p => p.color))];
            const types = ['All', ...new Set(products.map(p => p.type))];

            container.innerHTML = `
                <div class="mb-8 text-center fade-in px-4">
                    <h1 class="text-3xl md:text-4xl font-serif text-luxury-primary mb-4">The Collection</h1>
                    <p class="text-luxury-text max-w-2xl mx-auto text-sm md:text-base">
                        Browse our extensive catalog of premium eyewear. Use the filters below to refine your search by brand, aesthetic, or function.
                    </p>
                </div>

                <div class="flex flex-col lg:flex-row gap-8 fade-in">
                    <!-- Mobile Filter Toggle -->
                    <div class="lg:hidden px-4 w-full">
                        <button onclick="toggleMobileFilters()" class="w-full border border-luxury-primary text-luxury-primary py-3 text-sm uppercase font-bold flex justify-center items-center gap-2 hover:bg-luxury-primary hover:text-luxury-base transition-colors duration-300 rounded-sm">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path></svg>
                            <span>Filters & Sort</span>
                        </button>
                    </div>

                    <!-- Sidebar Filters -->
                    <aside id="shopFilters" class="hidden lg:block w-full lg:w-1/4 bg-luxury-surface p-6 rounded-lg shadow-sm h-fit sticky top-24 border border-luxury-secondary mx-4 lg:mx-0">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="font-bold tracking-widest uppercase text-sm text-luxury-primary">Filters</h3>
                            <button onclick="resetFilters()" class="text-xs text-luxury-accent hover:underline">Reset</button>
                        </div>
                        
                        <!-- Brand Filter -->
                        <div class="mb-6">
                            <label class="block text-xs font-bold text-luxury-text/70 uppercase mb-2">Brand</label>
                            <select onchange="updateFilter('brand', this.value)" class="w-full bg-luxury-base border border-luxury-secondary rounded p-2 text-sm text-luxury-primary focus:border-luxury-accent focus:ring-0 outline-none">
                                ${brands.map(b => `<option value="${b}" ${appState.filters.brand === b ? 'selected' : ''}>${b}</option>`).join('')}
                            </select>
                        </div>

                        <!-- Type Filter -->
                        <div class="mb-6">
                            <label class="block text-xs font-bold text-luxury-text/70 uppercase mb-2">Type</label>
                            <div class="space-y-2">
                                ${types.map(t => `
                                    <label class="flex items-center space-x-2 cursor-pointer text-luxury-primary">
                                        <input type="radio" name="type" value="${t}" onchange="updateFilter('type', this.value)" ${appState.filters.type === t ? 'checked' : ''} class="text-luxury-accent focus:ring-luxury-accent">
                                        <span class="text-sm">${t}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </div>

                        <!-- Color Filter -->
                        <div class="mb-6">
                            <label class="block text-xs font-bold text-luxury-text/70 uppercase mb-2">Color</label>
                            <div class="flex flex-wrap gap-2">
                                ${colors.filter(c => c !== 'All').map(c => `
                                    <button onclick="updateFilter('color', '${appState.filters.color === c ? 'All' : c}')" 
                                        class="w-6 h-6 rounded-full border ${appState.filters.color === c ? 'ring-2 ring-luxury-accent ring-offset-2' : 'border-luxury-secondary'}"
                                        style="background-color: ${getColorHex(c)}"
                                        title="${c}"
                                    ></button>
                                `).join('')}
                            </div>
                        </div>

                        <div class="pt-6 border-t border-luxury-secondary">
                             <label class="block text-xs font-bold text-luxury-text/70 uppercase mb-2">Sort By</label>
                             <select onchange="updateSort(this.value)" class="w-full bg-luxury-base border border-luxury-secondary rounded p-2 text-sm text-luxury-primary">
                                <option value="featured" ${appState.sortBy === 'featured' ? 'selected' : ''}>Featured</option>
                                <option value="priceAsc" ${appState.sortBy === 'priceAsc' ? 'selected' : ''}>Price: Low to High</option>
                                <option value="priceDesc" ${appState.sortBy === 'priceDesc' ? 'selected' : ''}>Price: High to Low</option>
                                <option value="az" ${appState.sortBy === 'az' ? 'selected' : ''}>Name: A - Z</option>
                             </select>
                        </div>
                    </aside>

                    <!-- Product Grid -->
                    <div class="w-full lg:w-3/4 px-4 lg:px-0">
                        <div class="mb-4 text-sm text-luxury-text/80">
                            Showing <span class="font-bold text-luxury-primary">${filteredProducts.length}</span> results
                        </div>
                        
                        ${filteredProducts.length > 0 ? `
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                ${filteredProducts.map(product => createProductCard(product)).join('')}
                            </div>
                        ` : `
                            <div class="flex flex-col items-center justify-center h-64 bg-luxury-surface rounded-lg border border-dashed border-luxury-secondary">
                                <span class="text-4xl mb-4 text-luxury-text/30">‚òπ</span>
                                <h3 class="text-lg font-medium text-luxury-text">No frames match your criteria.</h3>
                                <button onclick="resetFilters()" class="mt-4 text-luxury-accent underline">Clear all filters</button>
                            </div>
                        `}
                    </div>
                </div>
            `;
        }

        function renderAbout(container) {
            container.innerHTML = `
                <div class="max-w-4xl mx-auto fade-in">
                    <div class="text-center mb-16">
                        <h1 class="text-4xl md:text-5xl font-serif text-luxury-primary mb-6">Built on Trust & Passion</h1>
                        <div class="w-24 h-1 bg-luxury-accent mx-auto"></div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center mb-20">
                        <div class="bg-luxury-surface border border-luxury-secondary h-80 rounded-lg flex items-center justify-center shadow-sm">
                            <div class="text-center p-8">
                                <span class="text-6xl text-luxury-primary opacity-20 block mb-4">‚ùù‚ùû</span>
                                <p class="font-serif italic text-luxury-text">"Eyewear is not just an accessory. It is the framework through which you see the world."</p>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-2xl font-serif mb-4 text-luxury-primary">Our Difference</h3>
                            <p class="text-luxury-text leading-relaxed mb-6">
                                Unlike mass-market retailers, Lumina Optics is a sanctuary for independent eyewear design. 
                                We have spent over two decades cultivating relationships with small-batch artisans in Berlin, Copenhagen, and Italy.
                            </p>
                            <p class="text-luxury-text leading-relaxed">
                                We believe in "Slow Fashion" for your face. Every frame in our collection is chosen for its engineering integrity, 
                                material quality, and timeless aesthetic. When you choose Lumina, you aren't just buying glasses; 
                                you are investing in a piece of functional art.
                            </p>
                        </div>
                    </div>

                    <div class="bg-luxury-surface p-8 rounded-lg shadow-sm border-t-4 border-luxury-accent border-x border-b border-luxury-secondary">
                        <h3 class="text-xl font-bold mb-6 text-center text-luxury-primary">The Lumina Promise</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                            <div>
                                <div class="text-3xl mb-2 text-luxury-primary">‚ú¶</div>
                                <h4 class="font-bold text-sm uppercase mb-2 text-luxury-primary">Authenticity</h4>
                                <p class="text-sm text-luxury-text/80">Authorized retailer for every brand we carry. 100% genuine.</p>
                            </div>
                            <div>
                                <div class="text-3xl mb-2 text-luxury-primary">‚öí</div>
                                <h4 class="font-bold text-sm uppercase mb-2 text-luxury-primary">Craftsmanship</h4>
                                <p class="text-sm text-luxury-text/80">We only stock frames made from premium acetate, titanium, and steel.</p>
                            </div>
                            <div>
                                <div class="text-3xl mb-2 text-luxury-primary">‚ô•</div>
                                <h4 class="font-bold text-sm uppercase mb-2 text-luxury-primary">Care</h4>
                                <p class="text-sm text-luxury-text/80">Lifetime adjustments and comprehensive fitting support.</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderStylist(container) {
            container.innerHTML = `
                <div class="max-w-4xl mx-auto fade-in">
                    <div class="text-center mb-10">
                        <h1 class="text-4xl font-serif text-luxury-primary mb-4 flex justify-center items-center gap-3">
                            <span class="text-luxury-accent">‚ú®</span> Personal AI Stylist
                        </h1>
                        <p class="text-luxury-text max-w-2xl mx-auto">
                            Describe your facial features, personal style, and what you're looking for. 
                            Our AI will curate the perfect frames from our collection just for you.
                        </p>
                    </div>

                    <div class="bg-luxury-surface p-8 rounded-lg shadow-sm border border-luxury-secondary mb-10">
                        
                        <!-- Prompt Suggestion Chips -->
                        <div class="mb-6">
                            <p class="text-xs font-bold tracking-widest text-luxury-text/70 uppercase mb-3">Try asking for:</p>
                            <div class="flex flex-wrap gap-2">
                                <button onclick="setStylistPrompt('I have a round face and need something angular to add definition. Professional setting.')" class="bg-luxury-secondary/30 hover:bg-luxury-accent hover:text-luxury-base text-luxury-text text-xs px-4 py-2 rounded-full transition-colors border border-luxury-secondary shadow-sm">Angular for round face</button>
                                <button onclick="setStylistPrompt('I want something minimal, lightweight, and barely visible. Titanium optical frames.')" class="bg-luxury-secondary/30 hover:bg-luxury-accent hover:text-luxury-base text-luxury-text text-xs px-4 py-2 rounded-full transition-colors border border-luxury-secondary shadow-sm">Minimal & Lightweight</button>
                                <button onclick="setStylistPrompt('Bold, creative, and thick. Something that stands out and makes a statement.')" class="bg-luxury-secondary/30 hover:bg-luxury-accent hover:text-luxury-base text-luxury-text text-xs px-4 py-2 rounded-full transition-colors border border-luxury-secondary shadow-sm">Bold & Creative</button>
                                <button onclick="setStylistPrompt('Classic aviator sunglasses with a modern twist for weekend drives.')" class="bg-luxury-secondary/30 hover:bg-luxury-accent hover:text-luxury-base text-luxury-text text-xs px-4 py-2 rounded-full transition-colors border border-luxury-secondary shadow-sm">Classic Aviator Sun</button>
                                <button onclick="setStylistPrompt('Vintage tortoise shell opticals. Academia aesthetic.')" class="bg-luxury-secondary/30 hover:bg-luxury-accent hover:text-luxury-base text-luxury-text text-xs px-4 py-2 rounded-full transition-colors border border-luxury-secondary shadow-sm">Vintage Tortoise</button>
                                <button onclick="setStylistPrompt('I need sunglasses that offer maximum coverage but still look sleek and elegant.')" class="bg-luxury-secondary/30 hover:bg-luxury-accent hover:text-luxury-base text-luxury-text text-xs px-4 py-2 rounded-full transition-colors border border-luxury-secondary shadow-sm">Maximum coverage Sun</button>
                                <button onclick="setStylistPrompt('Something blue to match my wardrobe. Square or rectangular optical frames preferred.')" class="bg-luxury-secondary/30 hover:bg-luxury-accent hover:text-luxury-base text-luxury-text text-xs px-4 py-2 rounded-full transition-colors border border-luxury-secondary shadow-sm">Blue rectangular optical</button>
                            </div>
                        </div>

                        <textarea id="stylePrompt" rows="4" class="w-full bg-luxury-base border border-luxury-secondary rounded p-4 text-sm text-luxury-primary focus:border-luxury-accent focus:ring-1 focus:ring-luxury-accent outline-none transition-all resize-none mb-4 shadow-inner" placeholder="E.g., I have a square face and I work in a creative agency. I want something bold but professional..."></textarea>
                        
                        <button id="stylistBtn" onclick="handleStyleSubmit()" class="w-full bg-luxury-primary text-luxury-base py-4 font-bold tracking-wider hover:bg-luxury-accent transition-colors duration-300 flex justify-center items-center gap-2 shadow-md">
                            <span>DISCOVER MY FRAMES</span> <span class="text-xl">‚ú®</span>
                        </button>
                    </div>

                    <div id="stylistResults" class="hidden">
                        <!-- Results injected here -->
                    </div>
                </div>
            `;
        }

        function setStylistPrompt(text) {
            const textarea = document.getElementById('stylePrompt');
            textarea.value = text;
            textarea.focus();
        }

        async function handleStyleSubmit() {
            const promptInput = document.getElementById('stylePrompt').value;
            const resultsDiv = document.getElementById('stylistResults');
            const btn = document.getElementById('stylistBtn');

            if (!promptInput.trim()) return;

            btn.disabled = true;
            btn.innerHTML = `<svg class="animate-spin h-5 w-5 text-luxury-base" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> <span>CURATING YOUR LOOK...</span>`;
            resultsDiv.classList.remove('hidden');
            resultsDiv.innerHTML = `
                <div class="flex flex-col items-center justify-center py-12 text-luxury-text opacity-70 fade-in">
                    <div class="text-4xl mb-4 animate-pulse">‚ú®</div>
                    <p class="tracking-widest text-sm uppercase">Analyzing profile...</p>
                </div>
            `;

            try {
                const inventoryJSON = JSON.stringify(products.map(p => ({
                    id: p.id, brand: p.brand, name: p.name, type: p.type, color: p.color, material: p.material, shape: p.shape
                })));

                const combinedPrompt = `You are an elite, high-end eyewear stylist at Lumina Optics. 
                Based on the user's description of their style, face shape, and needs, select 2 to 3 frames from our inventory that fit them best.
                Inventory: ${inventoryJSON}
                User Request: ${promptInput}
                
                IMPORTANT: You must respond ONLY with a valid JSON object. Do not include markdown formatting. 
                The JSON must match this structure exactly:
                {
                    "introMessage": "Your luxurious, confident intro message explaining the vibe.",
                    "recommendations": [
                        { "productId": 1, "reason": "Specific reason this frame works for them based on face shape or vibe." }
                    ]
                }`;

                // Target backend 
                const response = await fetch('http://localhost:3000/api/stylist', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ userPrompt: combinedPrompt })
                });

                const data = await response.json();
                if (data.error) throw new Error(data.error);

                let cleanText = data.reply.replace(/```json/g, '').replace(/```/g, '').trim();
                const aiResult = JSON.parse(cleanText);

                let recommendationsHTML = aiResult.recommendations.map(rec => {
                    const product = products.find(p => p.id === rec.productId);
                    if (!product) return '';
                    return `
                        <div class="flex flex-col md:flex-row gap-8 bg-luxury-surface p-6 rounded-lg border border-luxury-secondary shadow-sm mb-6 fade-in cursor-pointer hover:border-luxury-accent transition-colors duration-300" onclick="openProductModal(${product.id})">
                            <div class="w-full md:w-1/3">
                                <div class="h-48 flex items-center justify-center bg-luxury-secondary/10 rounded border border-luxury-secondary/50 p-4">
                                     ${getGlassesSVG(product, '100%', 'auto', 'drop-shadow-md')}
                                </div>
                                <div class="mt-4 text-center">
                                    <span class="text-xs font-bold text-luxury-text/70 uppercase tracking-wider">${product.brand}</span>
                                    <h3 class="text-lg font-serif font-bold text-luxury-primary">${product.name}</h3>
                                </div>
                            </div>
                            <div class="w-full md:w-2/3 flex flex-col justify-center">
                                <h4 class="font-serif text-xl text-luxury-primary mb-3 flex items-center gap-2"><span class="text-luxury-accent">‚ú¶</span> Why this fits you</h4>
                                <p class="text-luxury-text leading-relaxed italic border-l-2 border-luxury-accent pl-5 py-2">"${rec.reason}"</p>
                            </div>
                        </div>
                    `;
                }).join('');

                resultsDiv.innerHTML = `
                    <div class="fade-in mb-10">
                        <div class="bg-luxury-secondary/20 p-8 rounded-lg border-t-4 border-luxury-accent border-x border-b border-luxury-secondary">
                            <p class="font-serif text-xl leading-relaxed text-luxury-primary">"${aiResult.introMessage}"</p>
                            <p class="text-sm font-bold tracking-widest uppercase mt-4 text-luxury-accent">‚Äî Your Virtual Stylist</p>
                        </div>
                    </div>
                    <div>${recommendationsHTML}</div>
                `;

            } catch (error) {
                console.error("Stylist Error:", error);
                resultsDiv.innerHTML = `
                    <div class="bg-red-50 dark:bg-red-900/20 text-red-500 p-4 rounded text-center border border-red-200 dark:border-red-800">
                        We apologize, but our stylist backend is currently unavailable. Please make sure your Node.js server (localhost:3000) is running!
                    </div>
                `;
            } finally {
                btn.disabled = false;
                btn.innerHTML = `<span>DISCOVER MY FRAMES</span> <span class="text-xl">‚ú®</span>`;
            }
        }


        // --- PRODUCT CARD & MODAL LOGIC ---

        function createProductCard(product) {
            return `
                <div class="group bg-luxury-surface rounded-lg border border-luxury-secondary overflow-hidden hover:shadow-xl transition-all duration-300 flex flex-col">
                    <!-- Image Area -->
                    <div class="h-64 w-full flex items-center justify-center relative overflow-hidden bg-luxury-secondary/20 cursor-pointer p-6" onclick="openProductModal(${product.id})">
                         <div class="w-full transition-transform duration-500 transform group-hover:scale-110 flex justify-center">
                             ${getGlassesSVG(product, '80%', 'auto', 'drop-shadow-lg')}
                         </div>
                         <div class="absolute inset-0 bg-luxury-primary/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"></div>
                         <div class="absolute bottom-4 text-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none w-full">
                             <span class="bg-luxury-primary/90 text-luxury-base backdrop-blur-sm text-xs px-3 py-1.5 uppercase tracking-widest rounded-sm shadow-md">Quick View</span>
                         </div>
                    </div>
                    
                    <div class="p-6 flex flex-col flex-grow">
                        <div class="flex justify-between items-start mb-2 cursor-pointer" onclick="openProductModal(${product.id})">
                            <span class="text-xs font-bold text-luxury-text/70 uppercase tracking-wider">${product.brand}</span>
                            <span class="text-sm font-medium text-luxury-accent">$${product.price}</span>
                        </div>
                        <h3 class="text-xl font-serif font-bold text-luxury-primary mb-1 cursor-pointer hover:text-luxury-accent transition-colors" onclick="openProductModal(${product.id})">${product.name}</h3>
                        <p class="text-sm text-luxury-text/80 mb-6 flex-grow cursor-pointer" onclick="openProductModal(${product.id})">${product.color} | ${product.material}</p>
                        
                        <button onclick="handleInquire(${product.id})" class="w-full border border-luxury-primary text-luxury-primary py-3 text-sm uppercase font-bold hover:bg-luxury-primary hover:text-luxury-base transition-colors duration-300 rounded-sm">
                            Inquire
                        </button>
                    </div>
                </div>
            `;
        }

        function openProductModal(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            const modal = document.getElementById('product-modal');
            const content = document.getElementById('product-modal-content');
            
            content.innerHTML = `
                <button onclick="closeProductModal()" class="absolute top-4 right-4 text-luxury-text hover:text-luxury-primary z-20 w-8 h-8 flex items-center justify-center rounded-full bg-luxury-surface/80 backdrop-blur shadow border border-luxury-secondary transition-colors text-lg">
                    ‚úï
                </button>
                
                <div class="w-full md:w-1/2 bg-luxury-secondary/20 flex items-center justify-center p-12 relative min-h-[300px]">
                    <div class="absolute inset-0 bg-gradient-to-tr from-luxury-primary/5 to-transparent"></div>
                    <div class="relative z-10 w-full flex justify-center transform scale-125 md:scale-150">
                        ${getGlassesSVG(product, '100%', 'auto', 'drop-shadow-2xl')}
                    </div>
                </div>
                
                <div class="w-full md:w-1/2 p-8 md:p-12 flex flex-col justify-center bg-luxury-surface">
                    <span class="text-xs font-bold text-luxury-accent uppercase tracking-widest mb-2">${product.brand}</span>
                    <h2 class="text-3xl md:text-4xl font-serif text-luxury-primary mb-3">${product.name}</h2>
                    <p class="text-xl text-luxury-text mb-6 font-medium">$${product.price}</p>
                    
                    <p class="text-sm text-luxury-text leading-relaxed mb-8">${product.desc}</p>
                    
                    <div class="space-y-4 border-t border-b border-luxury-secondary py-6 mb-8 text-sm">
                        <div class="flex justify-between"><span class="text-luxury-text/70 uppercase tracking-wider text-xs font-bold">Style</span><span class="font-medium text-luxury-primary">${product.type}</span></div>
                        <div class="flex justify-between"><span class="text-luxury-text/70 uppercase tracking-wider text-xs font-bold">Colorway</span><span class="font-medium text-luxury-primary">${product.color}</span></div>
                        <div class="flex justify-between"><span class="text-luxury-text/70 uppercase tracking-wider text-xs font-bold">Material</span><span class="font-medium text-luxury-primary">${product.material}</span></div>
                        <div class="flex justify-between"><span class="text-luxury-text/70 uppercase tracking-wider text-xs font-bold">Weight</span><span class="font-medium text-luxury-primary">${product.weight}g</span></div>
                        <div class="flex justify-between"><span class="text-luxury-text/70 uppercase tracking-wider text-xs font-bold">Silhouette</span><span class="font-medium text-luxury-primary capitalize">${product.shape}</span></div>
                    </div>
                    
                    <button onclick="handleInquire(${product.id}); closeProductModal()" class="w-full bg-luxury-primary text-luxury-base py-4 text-sm uppercase font-bold tracking-widest hover:bg-luxury-accent transition-colors duration-300 shadow-md rounded-sm">
                        Inquire About Frame
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
            // Force reflow
            void modal.offsetWidth;
            modal.classList.add('modal-enter');
            content.classList.add('modal-content-enter');
            
            // Prevent body scrolling
            document.body.style.overflow = 'hidden';
        }

        function closeProductModal() {
            const modal = document.getElementById('product-modal');
            const content = document.getElementById('product-modal-content');
            
            modal.classList.remove('modal-enter');
            content.classList.remove('modal-content-enter');
            
            setTimeout(() => {
                modal.classList.add('hidden');
                document.body.style.overflow = ''; // Restore scroll
            }, 300);
        }

        // --- INQUIRY LOGIC ---

        function handleInquire(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            const subject = encodeURIComponent(`Inquiry: ${product.brand} ${product.name}`);
            const body = encodeURIComponent(`Hello Lumina Optics team,\n\nI am interested in the ${product.brand} ${product.name} (${product.color}, ${product.type}). Could you provide more information on availability and pricing?\n\nThank you.`);
            
            window.location.href = `mailto:concierge@luminaoptics.com?subject=${subject}&body=${body}`;
        }
        
        function showGenericToast(content) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            
            toast.className = 'toast-msg bg-luxury-surface text-luxury-primary p-4 rounded-sm shadow-2xl transform transition-all duration-500 translate-y-10 opacity-0 min-w-[320px] border-l-4 border-luxury-accent border-y border-r border-luxury-secondary pointer-events-auto';
            
            // Allow string messages or full HTML injections
            if(typeof content === 'string' && !content.includes('<div')) {
                toast.innerHTML = `<p class="font-serif text-sm font-bold text-luxury-primary text-center w-full">${content}</p>`;
            } else {
                toast.innerHTML = content;
            }
            
            container.appendChild(toast);
            
            requestAnimationFrame(() => {
                toast.classList.remove('translate-y-10', 'opacity-0');
            });

            setTimeout(() => {
                toast.classList.add('opacity-0', 'translate-y-2');
                setTimeout(() => toast.remove(), 500);
            }, 4000);
        }

        function getColorHex(colorName) {
            const map = {
                'Black': '#000000',
                'Gold': '#D4AF37',
                'Tortoise': '#5C4033',
                'Silver': '#9CA3AF', 
                'Blue': '#1E3A8A'
            };
            return map[colorName] || '#CCCCCC';
        }

        function updateFilter(key, value) {
            appState.filters[key] = value;
            renderShop(document.getElementById('app-content'));
        }

        function updateSort(value) {
            appState.sortBy = value;
            renderShop(document.getElementById('app-content'));
        }

        function resetFilters() {
            appState.filters = { brand: 'All', color: 'All', type: 'All' };
            appState.sortBy = 'featured';
            renderShop(document.getElementById('app-content'));
        }

        function toggleMobileFilters() {
            const filters = document.getElementById('shopFilters');
            filters.classList.toggle('hidden');
        }

        // --- INITIALIZATION ---
        window.onload = function() {
            initTheme();
            renderPage('home', false);
        };

    </script>
</body>
</html>
